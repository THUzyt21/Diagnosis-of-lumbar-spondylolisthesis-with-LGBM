# Diagnosis-of-lumbar-spondylolisthesis-with-LGBM

this is for the article A machine learning based quantification system for automated diagnosis of lumbar spondylolisthesis on spinal X-rays.
Due to the large size of the original images, we have only uploaded the extracted features in this case, which can be found in the provided CSV file. In the file, the "编号" on the left side represents the individual, while the right side indicates the specific lumbar vertebra. The "label" column signifies whether the lumbar vertebra has undergone spondylolisthesis. 
the total process:
![Image](https://github.com/THUzyt21/Diagnosis-of-lumbar-spondylolisthesis-with-LGBM/tree/main/fd/总流程.png "Image")
## Mask RCNN model
The outcomes of our instance segmentation process, executed using the Mask R-CNN model, are meticulously stored in the 'regions.bin_pisa' file. This data file contains the results that have been meticulously refined from the raw outputs generated by the underlying neural network model. Two key methods are employed for enhancing the accuracy of the coordinate data extracted from the images: 'mend_one_list' focuses on the precise adjustment of lumbar vertebrae coordinates, whereas 'mend_box6' is dedicated to improving the representation of the sacrum. These methods involve sophisticated algorithms designed to correct any discrepancies in the initial segmentation, thereby ensuring that the final coordinates accurately reflect the anatomical structures of interest.

## LGBM Model
The LightGBM model was constructed utilizing the PyCaret library, with the primary creation process documented in the 'lgbmModel4dignosis.ipynb' notebook. The input to this model is derived from the 'regions2features' process, which extracts a 28-dimensional feature set from the CSV file mentioned earlier. We allocated 65% of the vertebral data for training the model and reserved 35% for testing, enabling us to train the model effectively and tune its parameters. Ultimately, we have decided to make both the experimental environment and the results transparent and accessible to the public

colmuns name stands for:

| Colmun Name  | Stands for |
| ------------- | ------------- |
| 编号  | example:366984_1, 366984 means a patient, 1 means the L1 lumbar|
| 图片序号2,3,4  | means neutral, lordotic, and kyphotic view of X-ray  |
| lineX, slopeX,ratioX  | Reference paper Fig4 Extracted low-order geometric features |
| PSD  | Reference paper reference[1] Extracted an angle feature |

The compare method is reference[1], can see in judgeByRulesCite19.py.

[1]Trinh G M, Shao H C, Hsieh K L C, et al. Detection of lumbar spondylolisthesis from X-ray images using deep learning network[J]. Journal of Clinical Medicine, 2022, 11(18): 5450.
